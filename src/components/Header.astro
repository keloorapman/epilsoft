---
import { translations } from '../i18n';

interface Props {
  lang?: 'fr' | 'en' | 'nl';
}

const { lang = 'fr' } = Astro.props;
const t = translations[lang];

// Pr√©fixe de langue pour les URLs
const langPrefix = lang === 'fr' ? '' : `/${lang}`;

// Langues disponibles
const languages = {
  'fr': { code: 'FR', url: '/' },
  'en': { code: 'EN', url: '/en/' },
  'nl': { code: 'NL', url: '/nl/' }
};

// Obtenir les autres langues (pas la langue actuelle)
const otherLanguages = Object.entries(languages).filter(([key]) => key !== lang);
const currentLangCode = languages[lang].code;
---

<!-- Barre promotionnelle -->
<div class="promo-bar">
  <div class="promo-content">
    <a href={`${langPrefix}/consultation-gratuite`} title="Consultation Gratuite & Zone Offerte">
      <span class="promo-text">üéÅ Consultation Gratuite & Zone Offerte</span>
      <span class="promo-cta">R√©server maintenant ‚Üí</span>
    </a>
  </div>
</div>

<header class="header" id="main-header">
  <div class="wrapper">
    <!-- Top secondary nav -->
    <nav class="top-secondary-nav">
      <ul>
        <li><a href={`${langPrefix}/faq`} title="FAQ">FAQ</a></li>
        <li><a href={`${langPrefix}/blog`} title="Blog">Blog</a></li>
        <li><a href={`${langPrefix}/consultation-gratuite`} title="Nos Promos" class="promo-link">Nos Promos</a></li>
      </ul>
    </nav>

    <a href={`${langPrefix}/`} class="logo" title="Epilsoft">
      <img src="/images/logo.svg" alt="Epilsoft √âpilation Laser" width="155" height="50" />
    </a>
    <nav class="header_nav" id="header-nav">
      <ul class="menu">
        <li><a href={`${langPrefix}/`} title="Accueil">Accueil</a></li>
        <li><a href={`${langPrefix}/technologie`} title="Technologie">Technologie</a></li>
        <li><a href={`${langPrefix}/traitement`} title="Traitement">Traitement</a></li>
        <li><a href={`${langPrefix}/epilation-femme`} title="Galerie">Galerie</a>
          <i></i>
          <ul class="sub">
            <li class="vue_mobile"><a href={`${langPrefix}/epilation-femme`} title="Vue d'ensemble">Vue d'ensemble</a></li>
            <li><a href={`${langPrefix}/epilation-femme`} title="Galerie Femme">Galerie Femme</a></li>
            <li><a href={`${langPrefix}/epilation-homme`} title="Galerie Homme">Galerie Homme</a></li>
          </ul>
        </li>
        <li><a href={`${langPrefix}/tarifs`} title="Tarifs">Tarifs</a></li>
        <li><a href={`${langPrefix}/centres`} title="Centres">Centres</a>
          <i></i>
          <ul class="sub">
            <li class="vue_mobile"><a href={`${langPrefix}/centres`} title="Vue d'ensemble">Vue d'ensemble</a></li>
            <li><a href={`${langPrefix}/centres#uccle`} title="Centre Uccle">Centre Uccle</a></li>
            <li><a href={`${langPrefix}/centres#etterbeek`} title="Centre Etterbeek">Centre Etterbeek</a></li>
          </ul>
        </li>
        <li><a href={`${langPrefix}/contact`} title="Contact">Contact</a></li>
        <li class="lang-inline">
          <div class="lang">
            <div class="current">{currentLangCode}</div>
            <div class="other">
              {otherLanguages.map(([key, langData]) => (
                <a href={langData.url} title={langData.code}>{langData.code}</a>
              ))}
            </div>
          </div>
        </li>
      </ul>
    </nav>
    <div class="lang-mobile">
      <div class="current">{currentLangCode}</div>
      <div class="other">
        {otherLanguages.map(([key, langData]) => (
          <a href={langData.url} title={langData.code}>{langData.code}</a>
        ))}
      </div>
    </div>
    <div class="menu_mobile" id="menu-mobile"><div></div></div>
  </div>
</header>

<style>
  /* Barre promotionnelle */
  .promo-bar {
    width: 100%;
    position: fixed;
    top: 0;
    left: 0;
    background: linear-gradient(135deg, #bfa477 0%, #d2bb94 100%);
    z-index: 101;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .promo-content {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 3vw;
  }

  .promo-content a {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    padding: 12px 0;
    text-decoration: none;
    color: #fff;
    font-family: "Barlow", sans-serif;
    transition: opacity 300ms ease;
  }

  .promo-content a:hover {
    opacity: 0.9;
  }

  .promo-text {
    font-size: 15px;
    font-weight: 600;
    letter-spacing: 0.3px;
  }

  .promo-cta {
    font-size: 14px;
    font-weight: 500;
    padding: 4px 12px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 4px;
    transition: background 300ms ease;
  }

  .promo-content a:hover .promo-cta {
    background: rgba(255, 255, 255, 0.3);
  }

  /* Header Semeraro Style */
  .header {
    width: 100%;
    position: fixed;
    top: 46px;
    left: 0;
    font-size: 0;
    line-height: 0;
    background: #fff;
    text-align: right;
    z-index: 100;
    border-bottom: 1px solid #e8e8e8;
  }

  .header .wrapper {
    width: 100%;
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 3vw;
  }

  /* Top secondary navigation (FAQ, Blog) */
  .top-secondary-nav {
    position: absolute;
    top: 5px;
    right: 60px;
    padding: 8px 0;
    z-index: 90;
    text-align: right;
  }

  .top-secondary-nav ul {
    display: flex;
    gap: 20px;
    list-style: none;
    padding: 0;
    margin: 0;
    justify-content: flex-end;
  }

  .top-secondary-nav li {
    display: inline-block;
  }

  .top-secondary-nav a {
    font-family: "Barlow", sans-serif;
    font-size: 12px;
    font-weight: 500;
    color: #999;
    text-decoration: none;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    transition: all 300ms ease;
  }

  .top-secondary-nav a:hover {
    color: #bfa477;
  }

  .top-secondary-nav a.promo-link {
    color: #fff;
    background: linear-gradient(135deg, #bfa477 0%, #d2bb94 100%);
    padding: 6px 16px;
    border-radius: 4px;
    font-weight: 600;
    letter-spacing: 0.8px;
  }

  .top-secondary-nav a.promo-link:hover {
    background: linear-gradient(135deg, #d2bb94 0%, #bfa477 100%);
    color: #fff;
  }

  .header .logo {
    width: 130px;
    position: absolute;
    left: 3vw;
    top: 50%;
    transform: translateY(-50%);
    z-index: 80;
    font-size: 0;
    margin-top: 10px;
  }

  .header .logo img {
    width: 100%;
    height: auto;
  }

  .header_nav {
    display: inline-block;
    vertical-align: middle;
    z-index: 40;
    margin-top: 40px;
    margin-right: -15px;
  }

  .header_nav .menu {
    display: block;
    position: relative;
    text-align: right;
  }

  .header_nav .menu li {
    display: inline-block;
    vertical-align: middle;
    position: relative;
    margin-left: 25px;
  }

  .header_nav .menu a {
    font: italic 15px/25px "PT Serif";
    letter-spacing: 0.4px;
    color: #222;
    display: inline-block;
    vertical-align: middle;
    padding: 0px 0 0px 0;
  }

  .header_nav .menu > li.active > a {
    color: #bfa477;
  }

  .header_nav .sub {
    width: 220px;
    text-align: center;
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -110px;
    display: block;
    visibility: hidden;
    opacity: 0;
    list-style: none;
    padding: 0;
    margin-top: 0;
  }

  .header_nav .sub li {
    width: 100%;
    margin: 0;
  }

  .header_nav .sub li a {
    width: 100%;
    height: 60px;
    line-height: 58px;
    color: #fff;
    padding: 0 30px;
    border-bottom: 1px solid #fff;
    background: #bfa477;
  }

  .header_nav .sub li:last-child a {
    border: none;
  }

  .header_nav .menu li:hover .sub {
    opacity: 1;
    visibility: visible;
    z-index: 999;
  }

  .header_nav .menu .sub li.active a {
    background: #d2bb94;
    color: #fff;
  }

  /* Language selector inline dans le menu */
  .lang-inline {
    position: relative;
  }

  .lang {
    display: inline-block;
    vertical-align: middle;
    font-size: 14px;
    line-height: 40px;
    font-weight: 700;
    letter-spacing: 1px;
    position: relative;
    z-index: 50;
    text-align: center;
  }

  .lang .current {
    width: 35px;
    height: 35px;
    line-height: 35px;
    border-radius: 50%;
    background: #8a7044;
    cursor: pointer;
    font-size: 12px;
    color: #fff;
  }

  .lang .other {
    width: 35px;
    position: absolute;
    left: 50%;
    margin-left: -17.5px;
    top: 55px;
    display: none;
  }

  .lang .other a {
    width: 35px;
    height: 35px;
    display: block;
    border-radius: 50%;
    background: #bfa477;
    color: #fff;
    margin-bottom: 5px;
    font-weight: 400;
    font-size: 11px;
    text-decoration: none;
    line-height: 35px;
  }

  /* Language selector for mobile */
  .lang-mobile {
    display: none;
    vertical-align: middle;
    font-size: 14px;
    line-height: 40px;
    font-weight: 700;
    letter-spacing: 1px;
    position: relative;
    margin: 0 auto;
    z-index: 50;
    text-align: center;
  }

  .lang-mobile .current {
    width: 40px;
    height: 40px;
    line-height: 40px;
    border-radius: 50%;
    background: #8a7044;
    cursor: pointer;
    color: #fff;
  }

  .lang-mobile .other {
    width: 40px;
    position: absolute;
    left: 50%;
    margin-left: -20px;
    top: 45px;
    display: none;
  }

  .lang-mobile .other a {
    width: 40px;
    height: 40px;
    display: block;
    border-radius: 50%;
    background: #bfa477;
    color: #fff;
    margin-bottom: 5px;
    font-weight: 400;
    font-size: 12px;
    text-decoration: none;
    line-height: 40px;
  }

  .menu_mobile {
    width: 60px;
    height: 60px;
    display: none;
    vertical-align: middle;
    cursor: pointer;
    position: relative;
    z-index: 50;
    margin: 0 -20px 0 5px;
  }

  .menu_mobile div {
    width: 30px;
    height: 2px;
    background: #222;
    position: absolute;
    right: 50%;
    top: 50%;
    margin: -1px -15px 0 0;
  }

  .menu_mobile div:before {
    width: 100%;
    height: 2px;
    background: #222;
    position: absolute;
    right: 0;
    top: 7px;
    content: "";
  }

  .menu_mobile div:after {
    width: 100%;
    height: 2px;
    background: #222;
    position: absolute;
    right: 0;
    top: -7px;
    content: "";
  }

  .menu_mobile.active div {
    height: 0;
  }

  .menu_mobile.active div:before {
    top: 0;
    transform: rotate(45deg);
  }

  .menu_mobile.active div:after {
    top: 0;
    transform: rotate(-45deg);
  }

  @media (min-width: 1201px) {
    .mobile-only {
      display: none;
    }

    .header_nav .menu_mobile {
      display: none;
    }

    .menu li:hover > a {
      color: #bfa477;
    }

    .menu .sub a:hover {
      background: #d2bb94;
      color: #fff;
    }

    .header_nav .menu a:after {
      width: 0;
      height: 1px;
      position: absolute;
      right: 0;
      bottom: 14px;
      background: #bfa477;
      content: "";
      transition: width 400ms ease-in-out;
    }

    .header_nav .menu > li.active > a:after {
      width: 20px;
    }

    .sub li:first-child,
    .vue_mobile {
      display: none;
    }

    .sub li:nth-child(2):after {
      width: 10px;
      height: 10px;
      position: absolute;
      left: 50%;
      top: -5px;
      margin: 0 0 0 -5px;
      transform: rotate(45deg);
      background: #bfa477;
      z-index: -1;
      content: "";
    }

    .sub li:nth-child(2):hover:after {
      background: #d2bb94;
    }

    .sub li.active:nth-child(2):after {
      background: #d2bb94;
    }

    .sub li.active a:after {
      background: #d2bb94;
    }

    .lang .current:hover {
      background-color: #d2bb94;
    }

    .lang .other a:hover {
      background-color: #d2bb94;
    }

    .lang-inline {
      margin-left: 10px;
    }

    .lang-mobile .current:hover {
      background-color: #d2bb94;
    }

    .lang-mobile .other a:hover {
      background-color: #d2bb94;
    }
  }

  @media (max-width: 1200px) {
    .top-secondary-nav {
      display: none;
    }

    .header .logo {
      margin-top: 0;
    }

    .lang-inline {
      display: none;
    }

    .lang-mobile {
      display: inline-block;
      margin: 10px 0 0 20px;
    }

    .header_nav {
      width: 100%;
      background: #181818;
      border-top: 60px solid #fff;
      position: absolute;
      right: -100%;
      top: 0;
      overflow-y: scroll;
      display: grid;
      transition: right 400ms ease-in-out 400ms;
      margin-top: 0;
    }

    .header_nav .menu {
      width: 100%;
      text-align: center;
      padding: 5vw;
      align-self: center;
      opacity: 0;
      transform: translateY(40px);
      transition: all 400ms ease-in-out 0ms;
    }

    .header_nav .menu li {
      width: 100%;
      display: block;
      margin: 0;
    }

    .header_nav .menu li a {
      display: block;
      padding: 0;
      color: #fff;
      text-transform: uppercase;
      font-size: 20px;
      font-style: normal;
      letter-spacing: 3px;
    }

    .header_nav .menu li i {
      width: 100%;
      height: 50px;
      position: absolute;
      left: 0;
      top: 0;
      display: block;
      z-index: 10;
    }

    .header_nav .menu .vue_mobile {
      display: block;
    }

    .header_nav .menu .sub {
      width: auto;
      visibility: visible;
      position: relative;
      left: auto;
      top: auto;
      margin: 5px 0;
      opacity: 1;
      display: none;
    }

    .header_nav .menu .sub li a {
      font: 400 16px/46px "Barlow";
      height: 46px;
      letter-spacing: 0.4px;
      text-transform: none;
      background: none;
      border: none;
    }

    .header_nav.active {
      right: 0;
      transition-delay: 0ms;
    }

    .header_nav.active .menu {
      opacity: 1;
      transform: translateY(0);
      transition-delay: 400ms;
    }

    .menu_mobile {
      display: inline-block;
    }
  }

  @media (max-width: 800px) {
    .promo-content a {
      flex-direction: column;
      gap: 8px;
      padding: 10px 0;
    }

    .promo-text {
      font-size: 13px;
    }

    .promo-cta {
      font-size: 12px;
      padding: 3px 10px;
    }

    .header {
      top: 70px;
    }

    .header .wrapper {
      padding: 0 7.5vw;
    }

    .header .logo {
      width: 120px;
      left: 7.5vw;
    }

    .header_nav {
      border-top-width: 60px;
    }

    .header_nav .menu li a {
      font-size: 16px;
      line-height: 48px;
    }

    .menu_mobile {
      height: 60px;
    }
  }
</style>

<script src="/js/header.js" defer></script>
